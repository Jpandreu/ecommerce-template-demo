/* Safari Mobile Fixes - Critical for proper functionality */

/* Force hardware acceleration for smoother performance */
* {
    -webkit-transform: translateZ(0);
}

/* Fix viewport height issues in Safari mobile */
:root {
    --vh: 1vh;
    --real-vh: calc(var(--vh, 1vh) * 100);
}

/* Mobile Safari specific fixes */
@supports (-webkit-touch-callout: none) {
    /* Safari-only styles */
    
    /* Fix for viewport height */
    .hero {
        min-height: 100vh;
        min-height: var(--real-vh);
        min-height: -webkit-fill-available;
    }
    
    /* Fix sticky header */
    .header {
        position: -webkit-sticky;
        position: sticky;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
    
    /* Fix mobile menu button */
    .mobile-menu-btn {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        user-select: none;
        cursor: pointer;
        z-index: 9999;
        position: relative;
        min-width: 44px !important;
        min-height: 44px !important;
        padding: 12px !important;
        touch-action: manipulation;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        will-change: transform;
    }
    
    /* Safari mobile hamburger lines */
    .mobile-menu-btn span {
        display: block !important;
        width: 25px !important;
        height: 3px !important;
        background-color: #333 !important;
        margin: 5px 0 !important;
        transition: 0.3s ease !important;
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
    }
    
    /* Active state animations */
    .mobile-menu-btn.active span:nth-child(1) {
        -webkit-transform: rotate(45deg) translate(5px, 5px) !important;
        transform: rotate(45deg) translate(5px, 5px) !important;
    }
    
    .mobile-menu-btn.active span:nth-child(2) {
        opacity: 0 !important;
    }
    
    .mobile-menu-btn.active span:nth-child(3) {
        -webkit-transform: rotate(-45deg) translate(7px, -6px) !important;
        transform: rotate(-45deg) translate(7px, -6px) !important;
    }
    
    /* Ensure menu button is clickable */
    .mobile-menu-btn:active {
        background-color: rgba(0, 0, 0, 0.1);
        -webkit-transform: scale(0.95);
        transform: scale(0.95);
    }
    
    /* Fix mobile navigation */
    .nav.mobile-open {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        background: rgba(255, 255, 255, 0.98) !important;
        -webkit-backdrop-filter: blur(20px) !important;
        backdrop-filter: blur(20px) !important;
        z-index: 9998 !important;
        overflow-y: auto !important;
        -webkit-overflow-scrolling: touch !important;
        padding-top: 100px !important;
        display: flex !important;
        flex-direction: column !important;
        align-items: center !important;
    }
    
    /* Fix mobile menu items */
    .nav.mobile-open .nav-link {
        display: block !important;
        width: 100% !important;
        text-align: center !important;
        padding: 1.5rem !important;
        font-size: 1.2rem !important;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1) !important;
        -webkit-tap-highlight-color: transparent !important;
    }
    
    /* Fix button interactions */
    .btn {
        -webkit-tap-highlight-color: transparent;
        -webkit-touch-callout: none;
        cursor: pointer;
        touch-action: manipulation;
    }
    
    .btn:active {
        transform: scale(0.98);
    }
    
    /* Fix form elements */
    input, select, textarea {
        -webkit-appearance: none;
        appearance: none;
        -webkit-border-radius: 0;
        border-radius: 0.5rem;
        font-size: 16px; /* Prevents zoom on focus */
    }
    
    /* Fix scroll behavior */
    body {
        -webkit-overflow-scrolling: touch;
        overflow-x: hidden;
    }
    
    /* Fix for sticky elements */
    .sticky {
        position: -webkit-sticky;
        position: sticky;
    }
    
    /* Prevent rubber band scrolling */
    body {
        overscroll-behavior-y: none;
    }
}

/* Additional Safari mobile fixes */
@media screen and (max-width: 767px) and (-webkit-min-device-pixel-ratio: 1) {
    
    /* Ensure proper touch targets */
    .mobile-menu-btn {
        min-width: 48px !important;
        min-height: 48px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        padding: 0.75rem !important;
    }
    
    /* Fix hamburger icon visibility */
    .hamburger {
        width: 24px !important;
        height: 24px !important;
        position: relative !important;
        display: block !important;
    }
    
    .hamburger span {
        display: block !important;
        height: 3px !important;
        width: 100% !important;
        background: currentColor !important;
        margin: 3px 0 !important;
        transition: 0.3s !important;
    }
    
    /* Ensure images load properly */
    img {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        image-rendering: -webkit-optimize-contrast;
    }
    
    /* Fix for product cards */
    .product-card,
    .service-card {
        -webkit-transform: translateZ(0);
        transform: translateZ(0);
        will-change: transform;
    }
    
    /* Fix animations */
    @media (prefers-reduced-motion: no-preference) {
        * {
            -webkit-animation-fill-mode: both;
            animation-fill-mode: both;
        }
    }
}

/* Critical fix for iPhone X and newer */
@supports (padding: max(0px)) {
    .header {
        padding-left: max(1rem, env(safe-area-inset-left));
        padding-right: max(1rem, env(safe-area-inset-right));
    }
    
    .nav.mobile-open {
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
        padding-bottom: env(safe-area-inset-bottom);
    }
}

/* Additional iOS Safari fixes */
@media screen and (-webkit-min-device-pixel-ratio: 2) {
    /* High DPI displays (Retina) */
    .mobile-menu-btn {
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        -webkit-perspective: 1000px;
        perspective: 1000px;
    }
    
    /* Fix for navigation links */
    .nav-link {
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1);
    }
    
    /* Improve button performance */
    .btn, .mobile-menu-btn {
        -webkit-transform: translate3d(0, 0, 0);
        transform: translate3d(0, 0, 0);
        -webkit-font-smoothing: antialiased;
    }
}

/* Debug helper for Safari mobile (remove in production) */
@media screen and (max-width: 767px) {
    .safari-debug {
        position: fixed;
        top: 0;
        left: 0;
        background: rgba(255, 0, 0, 0.8);
        color: white;
        padding: 5px;
        font-size: 12px;
        z-index: 10000;
        pointer-events: none;
        display: none; /* Enable with display: block for debugging */
    }
}